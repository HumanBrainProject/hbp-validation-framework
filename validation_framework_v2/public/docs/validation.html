<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1;maximum-scale=1; minimum-scale=1;">
    <title>EBRAINS Model Catalog:use an existing model with the EBRAINS research infrastructure</title>
    <link rel="apple-touch-icon" sizes="180x180" href="static/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/img/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="static/img/favicon-192x192.png">
    <link rel="icon" type="image/png" sizes="256x256" href="static/img/favicon-256x256.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/themes/prism.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="ebrains-minimal.css">

</head>

<body>
    <script src="cookieDisclaimer.js"></script>
    <main>
        <header>

            <nav class="navbar navbar-default navbar-light bg-light navbar-expand-lg">

                <a href="https://ebrains.eu/" aria-label="EBRAINS homepage"
                    class="logo nuxt-link-exact-active nuxt-link-active">
                    <img src="static/img/ebrains_logo.svg" alt="ebrains" height="60">
                </a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                    aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse navitems" id="navbarNavAltMarkup">
                    <ul class="navbar-nav app-links">
                        <li><a class="nav-item nav-link line" href="https://model-catalog.brainsimulation.eu/">
                            <span class="oi oi-book " title="Go to the Catalog" aria-hidden="true"></span>
                          </a></li>
                        <li><a class="nav-item nav-link line" href="index.html"
                                alt="About the Model Catalog">Introduction</a></li>
                        <li><a class="nav-item nav-link line" href="find.html"
                                alt="Find, understand and use interesting models">Find</a>
                        </li>
                        <li><a class="nav-item nav-link line " href="share.html"
                                alt="Share models with others">Share</a>
                        </li>
                        <li><a class="nav-item nav-link line " href="reuse.html"
                                alt="Use an existing model with the EBRAINS research infrastructure">Use</a></li>
                        <li><a class="nav-item nav-link line active" href="validation.html"
                                alt="Compare models to each other and to experimental data">Validate</a></li>
                        <li><a class="nav-item nav-link line" href="develop.html"
                                alt="Resources for developers">Develop</a></li>
                    </ul>
                </div>
            </nav>
            <div class="section title">
                <div class="container">
                    <div class="row">
                        <div class="col-sm align-self-center">
                            <h1>Validate models</h1>
                            <div>Compare models to each other and to experimental data</div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="section">
            <div class="container">
                <h5>Validation tests</h5>
                <h3>Defining validations</h3>
                <p>We have already seen the table of validation tests in the default view of the Model Catalog:</p>
                <div style="text-align:center;"><img src="static/figures/find/default_home.png"></div>
                <p>EBRAINS uses the <a href="https://scidash.org/sciunit.html">SciUnit</a> framework,
                which applies the idea of unit testing, widely used in software development, to model validation.
                In SciUnit, a <span class="code">Test</span> encapsulates:</p>
                <ul>
                    <li>the experimental data against which the simulation results are compared</li>
                    <li>the data analysis code used to transform the data generated by the model (e.g. spike times, membrane potential traces)
                        in the form needed for comparing to the data (e.g. a histogram)</li>
                    <li>the measure used to quantify the difference between simulation results and experimental data</li>
                </ul>
                <p>and is implemented as a Python class.</p>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <h5>Viewing</h5>
                <h3>Viewing validation test definitions</h3>
                <p>The table of validation test definitions can be configured and filtered as shown for models in <a href="find.html">Find models</a>
                    To view the detail of a test definition, click on a row in the table.
                    The "Info" tab shows a description of the test definition, assorted metadata,
                    and gives links to the code/data of all versions of the test code.
                </p>
                <div style="text-align:center;"><img src="static/figures/validate/example_test.png"></div>
                <p>To return to the table of models/tests, click "&#215;" in the upper-right corner.</p>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <h5>Results</h5>
                <h3>Viewing validation results</h3>
                <p>The "Results" tab shows the numerical results of validation tests, where the "Score" is a measure of the difference
                    between the experimental data and the simulation results. When accessed from a test definition, the Results tab
                    shows the scores for all models that have been validated with that test:</p>
                <div style="text-align:center;"><img src="static/figures/validate/results_for_test.png"></div>
                <p>When accessed from a model entry, the Results tab shows the scores for all tests that have been used to validate that model:</p>
                <div style="text-align:center;"><img src="static/figures/validate/results_for_model.png"></div>
                <p>The "Figures" tab shows the same information in graphical form:</p>
                <div style="text-align:center;"><img src="static/figures/validate/result_figures_for_test.png"></div>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <h5>In detail</h5>
                <h3>Inspecting individual validation results in detail</h3>
                <p>If you click on an individual score in the Results tab, this opens a dialog showing the details
                    of the test run that generated the score.</p>
                <div style="text-align:center;"><img src="static/figures/validate/result_info.png"></div>
                <p>Often, the plain numerical score is not very informative
                    about how the simulation results differed from the experimental data, and so validation test runs
                    can also generate additional figures and tables to provide a more in-depth view,
                    available in the "Result Files" tab.</p>
                    <div style="text-align:center;"><img src="static/figures/validate/result_files.png"></div>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <h5>Running</h5>
                <h3>Running validation tests</h3>
                <p>We've seen how to view validation test results, how are these results generated?
                    i.e. how do we launch the tests, run the simulations, and upload the results?
                </p>
                <p>Anyone with an EBRAINS account can use the Validation Framework Python client to do this
                    on their own computer, on a supercomputer (if they have access),
                    or in an EBRAINS Collaboratory Jupyter notebook (if the memory requirements of the
                    simulation do not exceed the limits of the virtual machine running the Python kernel).</p>

                <h4>Installing the Python client</h4>
                <pre><code class="language-sh">pip install hbp_validation_framework</code></pre>

                <h4>Downloading a model</h4>
                <pre><code class="language-sh">pip install hippounit</code></pre>
                <pre><code class="language-python">from hbp_validation_framework import ModelCatalog, TestLibrary
from hippounit.utils import ModelLoader_BPO

catalog = ModelCatalog(username="my_ebrains_username")
model_name = "CA1_pyr_cACpyr_mpg141208_B_idA_20190328144006"
model_info = catalog.list_models(name=model_name)[0]
local_path = catalog.download_model_instance(model_id=model_info["id"], version="2.0")
model = ModelLoader_BPO(name=model_name, model_dir=local_path,
                        SomaSecList_name="somatic")</code></pre>

                <p>The first time you run this, you will be asked to enter your password.
                    For subsequent runs, the client will store a token which it will use to reconnect,
                    until the token expires, when you will be asked again for the password.
                    If you run this in a Jupyter notebook inside the EBRAINS Collaboratory,
                    you should not need to enter either a username or password, as the authentication
                    you already provided for the Collaboratory also gives access to the Model Catalog.</p>

                <h4>Downloading a validation test</h4>
                <pre><code class="language-python">library = TestLibrary.from_existing(catalog)
validation_test = library.get_validation_test(alias="hippo_ca1_bap", version="1.3.5")</code></pre>

                <h4>Running a test and registering the result</h4>
                <pre><code class="language-python">result = validation_test.judge(model)
library.register_result(result)</code></pre>

                <p>This final step will run a simulation (provided you have NEURON, the simulator needed for this model, installed on your machine),
                    process the simulation data, and compare the result to the reference experimental data.
                    It then uploads the result (including the additional files and images generated during the test)
                    to the Model Catalog.</p>

                <p>For more details, see the
                   <a href="https://hbp-validation-client.readthedocs.io/en/master/">full Python client documentation</a>.</p>
            </div>
        </div>

        <div class="section">
            <div class="container">
                <h5>Contact</h5>
                <h3>Any questions?</h3>

                <p>If you have questions that are not answered here, contact us by e-mail: <a
                        href="mailto:support@ebrains.eu">support@ebrains.eu</a></p>
            </div>
        </div>

    </main>
    <footer class="site-footer">
        <div class="footer__content"> <a href="https://ebrains.eu/" aria-label="EBRAINS homepage"
                class="logo nuxt-link-exact-active nuxt-link-active">
                <img src="static/img/ebrains_logo.svg" alt="ebrains" height="60">
            </a>

            <p class="small-text">
            </p>
        </div>
        <div class="footer__end">
            <div class="footer__copyright">
                Copyright © 2020 EBRAINS. All rights reserved.
            </div>
        </div>
    </footer>
</body>

</html>